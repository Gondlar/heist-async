!function(){var doc=document,htm=doc.documentElement,lct=null,nearest=function(a,b){while(a&&a.nodeName!=b)a=a.parentNode;return a},replace_splices=function(resp){var div=document.createElement("div");div.innerHTML=resp;var elements=div.childNodes;for(i=0;i<elements.length;i++)if(elements[i].nodeName=="DIV"&&elements[i].hasAttribute("data-splice-name")){var rep=qwery("div[data-splice-name="+elements[i].getAttribute("data-splice-name")+"]");rep&&rep[0]&&rep[0].parentNode.replaceChild(elements[i],rep[0])}else if(elements[i].nodeName=="DIV"&&elements[i].hasAttribute("data-append-name")){var rep=qwery("div[data-append-name="+elements[i].getAttribute("data-append-name")+"]");if(rep&&rep[0]&&elements[i].childNodes)for(n=0;n<elements[i].childNodes.length;n++)elements[i].childNodes[n].nodeType==1&&rep[0].appendChild(elements[i].childNodes[n])}var scripts,scriptsFinder=/<script[^>]*>([\s\S]+)<\/script>/gi;while(scripts=scriptsFinder.exec(resp))eval(scripts[1])};htm.onclick=function(a){a=a||window.event,lct=a.target||a.srcElement;if(lct&&lct.nodeName==="BUTTON")bonzo(lct).addClass("processing");else{var b=nearest(lct,"A")||htm,c=b.href;switch(b.rel){case"async":case"async-post":b.getAttribute("data-loading-div")&&qwery(b.getAttribute("data-loading-div"))[0]&&(qwery(b.getAttribute("data-loading-div"))[0].innerHTML="<div class='loading'></div>"),reqwest({url:c,type:"html",success:replace_splices});break;default:return}return!1}},htm.onsubmit=function(a){a=a||window.event;var b=a.target||a.srcElement;if(!!b&&b.nodeName==="FORM"&&!!b.getAttribute("data-async")){b.getAttribute("data-loading-div")&&qwery(b.getAttribute("data-loading-div"))[0]&&(qwery(b.getAttribute("data-loading-div"))[0].innerHTML="<div class='loading'></div>"),reqwest({url:b.getAttribute("action")||"",data:reqwest.serialize(b),method:b.getAttribute("method")||"post",type:"html",success:replace_splices});return!1}}}()